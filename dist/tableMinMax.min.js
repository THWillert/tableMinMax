// (c) 2021 Thorsten Willert
// V2.1
// This code is licensed under MIT license
tableMinMax=function(t){let e,r=function t(e,r){for(var s in e=e||{},r)"object"==typeof r[s]?e[s]=t(e[s],r[s]):e[s]=r[s];return e}({table:"table",search:{mode:"all",nr:[1]},limit:{min:"min",max:"max"},css:{mode:"style",max:"",min:""},text:{autocontrast:!0,threshold:130,light:"#fff",dark:"#000"},colorize:"span",mode:"single",invert:!1},t),s=Number.MAX_VALUE,a=Number.MIN_VALUE,l=0,c=0,n=0,o=0,i=0,u=0,m=null,h=null,d=null,b=null;try{if(m=document.querySelector(r.table),null===m)return[-1,-1];h=document.querySelector(r.table+" tbody"),u=h.rows.length}catch(t){return[-1,-1]}m.hasAttribute("data-search-mode")&&(r.search.mode=m.getAttribute("data-search-mode")),m.hasAttribute("data-search-nr")&&(r.search.nr=m.getAttribute("data-search-nr")),m.hasAttribute("data-autocontrast")&&(r.text.autocontrast="true"===m.getAttribute("data-autocontrast")),m.hasAttribute("data-css-min")&&(r.css.min=m.getAttribute("data-css-min")),r.css.min=r.css.min.trim().replace(/\s\s+/g," "),m.hasAttribute("data-css-max")&&(r.css.max=m.getAttribute("data-css-max")),r.css.max=r.css.max.trim().replace(/\s\s+/g," "),m.hasAttribute("data-colorize")&&(r.css.max=m.getAttribute("data-colorize"));let x=r.search.nr.length;switch(r.search.mode.toString()){case"col":for(let t=0;t<x;t++){s=Number.MAX_VALUE,a=Number.MIN_VALUE;for(let n=0;n<u;n++)e=parseFloat(h.rows[n].cells[r.search.nr[t]].innerText),e>a&&(a=e,c=n),e<s&&(s=e,l=n);d=h.rows[l].cells[r.search.nr[t]],b=h.rows[c].cells[r.search.nr[t]],g(d,b,r)}break;case"row":for(let t=0;t<x;t++){s=Number.MAX_VALUE,a=Number.MIN_VALUE,i=h.rows[t].cells.length;for(let n=0;n<i;n++)e=parseFloat(h.rows[r.search.nr[t]].cells[n].innerText),e>a&&(a=e,c=n),e<s&&(s=e,l=n);d=h.rows[r.search.nr[t]].cells[l],b=h.rows[r.search.nr[t]].cells[c],g(d,b,r)}break;default:for(let t=0;t<u;t++){i=h.rows[t].cells.length;for(let r=0;r<i;r++)e=parseFloat(h.rows[t].cells[r].innerText),e>a&&(a=e,c=t,o=r),e<s&&(s=e,l=t,n=r)}d=h.rows[l].cells[n],b=h.rows[c].cells[o],g(d,b,r)}function g(t,e,r){!0===r.invert&&([t,e]=[e,t]),"span"===r.colorize?(t.innerHTML='<span class="'+r.css.min+'">'+t.innerHTML+"</span>",e.innerHTML='<span class="'+r.css.max+'">'+e.innerHTML+"</span>"):(t.className+=r.css.min,e.className+=r.css.max),!0===r.text.autocontrast&&(A(t,r.css.min,r.text.threshold),A(e,r.css.max,r.text.threshold))}function A(t,e,s){var a;color=window.getComputedStyle(document.querySelector((a=e,"."+a.split(" ").join(".")))).getPropertyValue("background-color"),t.style.color=function(t,e=130,r,s){return aC=t.match(/[0-9.]+/gi),aC.length<3?"#000":(cB=(299*aC[0]+587*aC[1]+114*aC[2])/1e3,cB>e?s:r)}(color,s,r.text.light,r.text.dark)}return[s,a]};
