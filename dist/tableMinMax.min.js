// (c) 2021 Thorsten Willert
// V2.1
// This code is licensed under MIT license
tableMinMax=function(e){const a=N({table:"table",search:{mode:"all",t:[1]},o:{min:"min",max:"max"},l:{mode:"style",max:"",min:""},text:{i:true,u:"readable",min:"#fff",max:"#000"},m:"span",mode:"single",p:false},e);let o=Number.MAX_VALUE;let n=Number.MIN_VALUE;let l=0;let r=0;let c=0;let s=0;let i=0;let f=0;let t=null;let u=null;let d=null;let m=null;try{t=document.querySelector(a.table);if(t===null){console.log(`tableMinMax: table not found: ${a.table} \n Function call after table init? (e.g. end of body)`);return[-1,-1]}u=document.querySelector(a.table+" tbody");f=u.rows.length}catch(g){console.error(g);return[-1,-1]}if(t.hasAttribute("data-search-mode")){a.search.mode=t.getAttribute("data-search-mode")}if(t.hasAttribute("data-search-nr")){a.search.t=t.getAttribute("data-search-nr")}if(t.hasAttribute("data-autocontrast")){a.text.i=t.getAttribute("data-autocontrast")==="true"}if(t.hasAttribute("data-css-min")){a.l.min=t.getAttribute("data-css-min")}a.l.min=a.l.min.trim().replace(/\s\s+/g," ");if(t.hasAttribute("data-css-max")){a.l.max=t.getAttribute("data-css-max")}a.l.max=a.l.max.trim().replace(/\s\s+/g," ");if(t.hasAttribute("data-colorize")){a.l.max=t.getAttribute("data-colorize")}let b;const p=a.search.t.length;let x;switch(a.search.mode.toString()){case"col":for(let t=0;t<p;t++){o=Number.MAX_VALUE;n=Number.MIN_VALUE;for(let e=0;e<f;e++){x=a.search.t[t];b=parseFloat(u.rows[e].cells[x.innerText]);if(b>n){n=b;r=e;continue}if(b<o){o=b;l=e}}d=u.rows[l].cells[x];m=u.rows[r].cells[x];h(d,m,a)}break;case"row":for(let e=0;e<p;e++){o=Number.MAX_VALUE;n=Number.MIN_VALUE;x=a.search.t[e];i=u.rows[e].cells.length;for(let e=0;e<i;e++){b=parseFloat(u.rows[x].cells[e].innerText);if(b>n){n=b;r=e;continue}if(b<o){o=b;l=e}}d=u.rows[x].cells[l];m=u.rows[x].cells[r];h(d,m,a)}break;default:for(let t=0;t<f;t++){i=u.rows[t].cells.length;for(let e=0;e<i;e++){b=parseFloat(u.rows[t].cells[e].innerText);if(b>n){n=b;r=t;s=e;continue}if(b<o){o=b;l=t;c=e}}}d=u.rows[l].cells[c];m=u.rows[r].cells[s];h(d,m,a)}function h(e,t,a){if(a.p===true){[e,t]=[t,e]}if(a.m==="span"){e.innerHTML=`<span class="${a.l.min}">${e.innerHTML}</span>`;t.innerHTML=`<span class="${a.l.max}">${t.innerHTML}</span>`}else{e.className+=a.l.min;t.className+=a.l.max}try{if(typeof color2k.h==="function"){console.log("color2k loaded");if(a.text.i===true){k(e,a.l.min,a.text.u);k(t,a.l.max,a.text.u)}}else{console.log("color2k not loaded")}}catch(g){console.log(g)}}function k(e,t,a){const o=window.getComputedStyle(document.querySelector(y(t))).getPropertyValue("background-color");if(color2k.h(o,a)===false){e.style.color="#fff"}else{e.style.color="#000"}}function y(e){const t=e.split(" ");return"."+t.join(".")}function N(e,t){e=e||{};for(var a in t){if(typeof t[a]==="object"){e[a]=N(e[a],t[a])}else{e[a]=t[a]}}return e}return[o,n]};
